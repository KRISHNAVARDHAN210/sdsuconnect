<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nest - SDSU Connect</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body { margin: 0; font-family: 'Roboto', sans-serif; background-color: #f5f5f5; }
    .navbar { display: flex; background-color: #C41230; padding: 1rem 2rem; align-items: center; justify-content: space-between; }
    .nav-links { display: flex; gap: 2rem; }
    .nav-links div { color: white; font-weight: bold; cursor: pointer; }
    .filter-section { margin: 2rem; display: flex; gap: 1rem; flex-wrap: wrap; }
    select { padding: 0.5rem; border-radius: 4px; font-size: 1rem; }
    .listing-list { margin: 2rem; display: flex; flex-direction: column; gap: 1rem; }
    .listing-card { background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; cursor: pointer; }
    .listing-card:hover { box-shadow: 0 0 10px rgba(0,0,0,0.2); }
    .listing-info { display: flex; align-items: center; justify-content: space-between; }
    .listing-basic { display: flex; align-items: center; gap: 1rem; }
    .building-pic { width: 60px; height: 60px; background-color: #ddd; border-radius: 8px; }
    .listing-details { display: flex; flex-direction: column; }
    .hidden-details { display: none; background-color: #f9f9f9; margin-top: 10px; padding: 0.8rem; border-radius: 6px; font-size: 0.9rem; }
    .message-btn { background-color: #C41230; color: white; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; }
    .message-btn:hover { background-color: #a50d24; }
    .create-listing { margin: 2rem; text-align: center; }
    .create-listing button { background-color: #C41230; color: white; padding: 0.8rem 2rem; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; }
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    .modal-content { background-color: white; padding: 2rem; border-radius: 8px; width: 400px; position: relative; }
    .modal-content input, .modal-content select { width: 100%; margin-bottom: 15px; padding: 0.8rem; border: 1px solid #ccc; border-radius: 4px; }
    .modal-content button { margin-top: 1rem; width: 100%; }
    .close-btn { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer;} 
        .profile-section {
      text-align: center;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    .profile-section img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-bottom: 0.2rem;
      object-fit: cover;
      
    }
  </style>
</head>

<body>

<!-- Navbar -->
<div class="navbar">
    <div class="nav-links">
      <div>
        <img src="/static/Logo.jpg" alt="SDSU Aztec Connect" style="height:40px;">
      </div>
      <div><a href="/roomies" style="color: white; text-decoration: none;">ROOMIES</a></div>
    <div><a href="/nest" style="color: white; text-decoration: none;"><u>NEST</u></a></div>
    <div><a href="/forum" style="color: white; text-decoration: none;">FORUM</a></div>
    </div>
  
    <div class="profile-section">
      <img src="/static/profile.png" alt="Profile">
      <div>PROFILE</div>
    </div>
  </div>

  <div class="filter-section">
    <select id="campus-filter" onchange="loadListings()">
      <option value="">On Campus / Off Campus</option>
      <option>On Campus</option>
      <option>Off Campus</option>
    </select>
  </div>
  
  <!-- Listings -->
  <div class="listing-list" id="listing-list"></div>
  
  <!-- Create Listing Button -->
  <div class="create-listing">
    <button onclick="openModal()">+ Create Listing</button>
  </div>
  
  <!-- Modal for Create Listing -->
  <div class="modal" id="create-modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">Ã—</span>
      <h2>Create Listing</h2>
      <input id="building-name" placeholder="Building Name / Number">
      <input id="address" placeholder="Address">
      <select id="campus-type">
        <option>On Campus</option>
        <option>Off Campus</option>
      </select>
      <input id="availability-date" placeholder="Availability Date (e.g., May 2025)">
      <input id="listed-by" placeholder="Listed By">
      <select id="lease-type">
        <option>Lease Transfer</option>
        <option>New Lease</option>
      </select>
      <select id="space">
        <option>Private room</option>
        <option>Shared spot</option>
      </select>
      <button onclick="createListing()">Create</button>
    </div>
  </div>
  
  <script>
  // Dummy Listings
  let dummyListings = [
    {
      id: 1,
      building: "The Rive Apartments",
      availability_date: "May 2025",
      address: "6345 El Cajon Blvd, San Diego",
      listed_by: "John Doe",
      lease_type: "Lease Transfer",
      space: "Shared spot",
      campus_type: "Off Campus"
    },
    {
      id: 2,
      building: "Zura",
      availability_date: "June 2025",
      address: "5500 San Diego State University",
      listed_by: "Jane Smith",
      lease_type: "New Lease",
      space: "Private room",
      campus_type: "On Campus"
    }
  ];
  
  function loadListings() {
    const campus = document.getElementById('campus-filter').value;
    const list = document.getElementById('listing-list');
    list.innerHTML = '';
  
    const filtered = dummyListings.filter(l => !campus || l.campus_type === campus);
  
    filtered.forEach(listing => {
      const card = `
        <div class="listing-card" onclick="toggleDetails(${listing.id})">
          <div class="listing-info">
            <div class="listing-basic">
              <div class="building-pic"></div>
              <div class="listing-details">
                <strong>${listing.building}</strong>
                <div>Available: ${listing.availability_date}</div>
                <div>Location: ${listing.address}</div>
              </div>
            </div>
            <button class="message-btn" onclick="event.stopPropagation(); messageUser(${listing.id});">Message</button>
          </div>
          <div class="hidden-details" id="details-${listing.id}" style="display:none;">
            <p><strong>Listed by:</strong> ${listing.listed_by}</p>
            <p><strong>Lease Type:</strong> ${listing.lease_type}</p>
            <p><strong>Space:</strong> ${listing.space}</p>
            <p><strong>Campus Type:</strong> ${listing.campus_type}</p>
          </div>
        </div>
      `;
      list.innerHTML += card;
    });
  }
  
  function toggleDetails(id) {
    const details = document.getElementById(`details-${id}`);
    details.style.display = (details.style.display === "none" || details.style.display === "") ? "block" : "none";
  }
  
  function openModal() {
    document.getElementById('create-modal').style.display = 'flex';
  }
  
  function closeModal() {
    document.getElementById('create-modal').style.display = 'none';
  }
  
  function createListing() {
    const newListing = {
      id: dummyListings.length + 1,
      building: document.getElementById('building-name').value,
      address: document.getElementById('address').value,
      campus_type: document.getElementById('campus-type').value,
      availability_date: document.getElementById('availability-date').value,
      listed_by: document.getElementById('listed-by').value,
      lease_type: document.getElementById('lease-type').value,
      space: document.getElementById('space').value
    };
  
    dummyListings.push(newListing);
    closeModal();
    loadListings();
  }
  
  function messageUser(id) {
    alert(`Messaging for listing id ${id}`);
  }
  
  // Initial Load
  window.onload = loadListings;
  </script>
  
  </body>
  </html>